<!doctype html>
<html class="no-js" lang="">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>  Report / Roles Usage </title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="manifest" href="site.webmanifest">
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.png">
    <!-- Place favicon.png in the root directory -->
    <!-- CSS here -->
    <link rel="stylesheet" href="css/bootstrap.min.css"> 
    <link rel="stylesheet" href="css/fontawesome-all.min.css">
    <link rel="stylesheet" href="css/et-line-fonts.css">
    <link rel="stylesheet" href="css/themify-icons.css"> 
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css"> 
    <link rel="stylesheet" href="css/default.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <div class="body-wrapper body-bg">
        <!-- header start -->
        <header>

            <div class="menu-area white-bg header-sticky d-none d-lg-block">
                <div class="container">
                    <div class="menu-box">
                        <div class="row">
                            <div class="col-xl-9 col-lg-9">
                                <div class="main-menu">
                                    <nav id="mobile-menu">
                                        <ul>
                                            <li>
                                                <a href="index.html">Dashboard</a>

                                            </li>
                                            <li>
                                                <a href="widgets.html">Widgets</a>
                                            </li>
                                            <li class="mega-menu static">
                                                <a href="#">Elements</a>
                                            </li>
                                            <li>
                                                <a href="#">Forms</a>

                                            </li>
                                            <li>
                                                <a href="#">Charts</a>

                                            </li>
                                            <li>
                                                <a href="#">Pages</a>
                                                <ul class="submenu  level-1">
                                                    <li>
                                                        <a href="login.html">Login</a>
                                                    </li>
                                                    <li>
                                                        <a href="login-2.html">Login 2</a>
                                                    </li>
                                                    <li>
                                                        <a href="register.html">Register</a>
                                                    </li>
                                                    <li>
                                                        <a href="register-2.html">Register 2</a>
                                                    </li>
                                                    <li>
                                                        <a href="lock.html">Lock Page</a>
                                                    </li>
                                                    <li>
                                                        <a href="invoice.html">Invoice Page</a>
                                                    </li>
                                                    <li>
                                                        <a href="404.html">404 Page</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <a href="carousel.html">Gallery</a>
                                            </li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                            <div class="col-xl-3 col-lg-3 d-md-none d-lg-block">
                                <div class="social-links text-rights mt-10">
                                    <ul class="navbar-nav justify-content-end navbar-nav-right demo-navbar-messages">
                                        <li class="nav-item dropdown">
                                            <a class="nav-link count-indicator dropdown-toggle" id="messageDropdown" href="#"
                                               data-toggle="dropdown" aria-expanded="false">
                                                <i class="fas fa-bell"></i>
                                                <span class="count">4</span>
                                            </a>
                                            <div class="dropdown-menu dropdown-menu-right">
                                                <div class="bg-danger text-center text-white font-weight-bold p-3">
                                                    4 New Notifications
                                                </div>
                                                <div class="list-group list-group-flush">
                                                    <a href="javascript:void(0)" class="list-group-item list-group-item-action media d-flex align-items-center">
                                                        <div class="ui-icon ui-icon-sm ion ion-md-home bg-secondary border-0 text-white"></div>
                                                        <div class="media-body line-height-condenced ml-3">
                                                            <div class="text-dark">Login from 192.168.1.1</div>
                                                            <div class="small mt-1">
                                                                Aliquam ex eros, imperdiet vulputate hendrerit et.
                                                            </div>
                                                            <div class="small mt-1">12h ago</div>
                                                        </div>
                                                    </a>

                                                    <a href="javascript:void(0)" class="list-group-item list-group-item-action media d-flex align-items-center">
                                                        <div class="ui-icon ui-icon-sm ion ion-md-person-add bg-info border-0 text-white"></div>
                                                        <div class="media-body line-height-condenced ml-3">
                                                            <div class="text-dark">
                                                                You have
                                                                <strong>4</strong> new followers
                                                            </div>
                                                            <div class="small mt-1">
                                                                Phasellus nunc nisl, posuere cursus pretium nec, dictum
                                                                vehicula tellus.
                                                            </div>
                                                        </div>
                                                    </a>

                                                    <a href="javascript:void(0)" class="list-group-item list-group-item-action media d-flex align-items-center">
                                                        <div class="ui-icon ui-icon-sm ion ion-md-power bg-danger border-0 text-white"></div>
                                                        <div class="media-body line-height-condenced ml-3">
                                                            <div class="text-dark">Server restarted</div>
                                                            <div class="small mt-1">
                                                                19h ago
                                                            </div>
                                                        </div>
                                                    </a>

                                                    <a href="javascript:void(0)" class="list-group-item list-group-item-action media d-flex align-items-center">
                                                        <div class="ui-icon ui-icon-sm ion ion-md-warning bg-warning border-0 text-dark"></div>
                                                        <div class="media-body line-height-condenced ml-3">
                                                            <div class="text-dark">99% server load</div>
                                                            <div class="small mt-1">
                                                                Etiam nec fringilla magna. Donec mi metus.
                                                            </div>
                                                            <div class="small mt-1">
                                                                20h ago
                                                            </div>
                                                        </div>
                                                    </a>
                                                </div>
                                                <a href="javascript:void(0)" class="d-block text-center text-black p-2 my-1">
                                                    Show all notifications
                                                </a>
                                            </div>
                                        </li>
                                        <li class="nav-item dropdown">
                                            <a class="nav-link count-indicator dropdown-toggle" id="notificationDropdown" href="#"
                                               data-toggle="dropdown">
                                                <i class="far fa-user"></i>
                                            </a>
                                            <div class="dropdown-menu dropdown-menu-right">

                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </header>
        <!-- header end -->
        <!-- dashboard-area start -->
        <div class="dashboard-area pt-30">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="pannel-wrapper white-bg mb-30">
                            <div class="panel-heading heading-border">
                                <h4>Reports / Roles Usage</h4>
                            </div>
                            <div class="panel-body">
                                <div class="table-responsive">
                                    <table id="table_name"
                                           class="table table-striped table-bordered"
                                           style="width: 100%">
                                        <thead>
                                            <tr>
                                                <th>Role Name</th>
                                                <th>Role Usage  %</th>
                                                <th>Users Count</th>
                                            </tr>
                                        </thead>
                                        <tbody id="table-body">

                                            <!-- Contenido dinamico >-->

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- dashboard-area end -->
        <!-- footer start -->
        <footer>
            <div class="footer-area">
                <div class="container">
                    <div class="copyright white-bg pt-25 pb-25 text-center">
                        <p>Copyright © 2025. All rights reserved. Design by David Martínez.</p>
                    </div>
                </div>
            </div>
        </footer>
        <!-- footer start -->

    </div>

    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            const tbody = document.getElementById("table-body");

            try {

                const baseUrl = `https://localhost`;
                const controllerName = `DataQuery`;
                const port = `44311`;
                const apiUrl = `${baseUrl}:${port}/${controllerName}/ObtenerRolesUsuarios`; 

                const response = await fetch(apiUrl);

                if (!response.ok) {
                    throw new Error("Error al obtener los datos");
                }

                const data = await response.json();
                var result = false; 
                data.forEach((item) => {
                    const row = document.createElement("tr");

                    row.innerHTML = ` <td>${item.rol}</td>
                                      <td>${item.rolUsage}</td>
                                      <td>${item.usuariosCount}</td> `; 
                    tbody.appendChild(row);
                    result = true;
                });

                if (result == true) {
                    const oddRow = document.querySelector("#example tbody tr.odd");

                    if (oddRow) {
                        oddRow.remove();
                    }
                }

            } catch (error) {
                console.error("Hubo un problema al cargar la tabla:", error);
                tbody.innerHTML =
                    '<tr><td colspan="6" class="text-center text-danger">Error al cargar datos</td></tr>';
            }
        });
    </script> 

    <!-- JS here -->
    <script src="js/vendor/modernizr-3.5.0.min.js"></script>
    <script src="js/vendor/jquery-1.12.4.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>  
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>
    <script src="js/plugins.js"></script>
    <!-- active code -->
    <script src="js/main.js"></script>
    <script src="js/DataTable.js"></script>
</body>
</html>
